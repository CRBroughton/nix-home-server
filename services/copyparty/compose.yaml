# Copyparty - File sharing server
# Run with: podman compose up -d

services:
  copyparty:
    image: docker.io/copyparty/ac:latest
    container_name: copyparty
    restart: unless-stopped

    ports:
      - "3923:3923"

    volumes:
      # Files to share
      - ./data:/w:Z
      # Config file (not in /cfg to avoid auto-discovery conflict)
      - ./config/copyparty.conf:/etc/copyparty.conf:ro,Z

    # Use config file
    command: ["-c", "/etc/copyparty.conf"]

    # Security
    security_opt:
      - no-new-privileges:true

    # Resource limits
    deploy:
      resources:
        limits:
          memory: 512M
          cpus: '2.0'
        reservations:
          memory: 64M

    # Logging
    logging:
      driver: "journald"
      options:
        tag: "copyparty"
